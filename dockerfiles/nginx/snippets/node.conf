# --- Vite dev server proxy (no :5173 exposure) ---
location ^~ /@vite/ {
    proxy_pass http://node:5173;
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

location ^~ /@id/ {
    proxy_pass http://node:5173;
    proxy_set_header Host $host;
}

location ^~ /@fs/ {
    proxy_pass http://node:5173;
    proxy_set_header Host $host;
}

# Vite uses websockets for HMR
location /vite {
    proxy_pass http://node:5173;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header Host $host;
}

# Some setups also need these for direct module fetches
location ^~ /resources/ {
    proxy_pass http://node:5173;
    proxy_set_header Host $host;
}

location ^~ /node_modules/ {
    proxy_pass http://node:5173;
    proxy_set_header Host $host;
}
